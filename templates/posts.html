{% extends 'base.html' %}
{% block content %}
<h1 class="display-1">Feed</h1>

<div>
    <nav class="navbar">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="/user/posts">All</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/user/posts/following">Following</a>
            </li>
        </ul>
    </nav>
</div>
{% block if %}
{% endblock %}
<div>
    {% for post in posts %}
        {% for content in post_details %}
            {% if post.content_id == content.id %}
            <div class="card" style="width: 18rem;">
                <img src="{{img_url}}{{content.poster_path}}" class="card-img-top" alt="{{content.original_title or content.name}} Poster">
                <div class="card-body">
                    <h5 class="card-title"><a
                        {% if post.content_type == 'm' %}
                        href="/movie/{{content.id}}"
                        {% elif post.content_type == 't' %}
                        href="/tv/{{content.id}}"
                        {% endif %}
                        >{{content.original_title or content.name}}</a></h5>
                    <p><i>@<a href="/user/{{post.user_id}}">{{post.user.username}}</a></i></p>
                    <p class="card-text">{{post.content}}</p>
                    {% if session['user_id'] == post.user_id %}
                        <form action="/posts/{{post.id}}/delete"> 
                            <button class="btn">
                                <i class="bi bi-trash3"></i>
                            </button>
                        </form>
                        <form action="/posts/{{post.id}}/edit">
                            <button class="btn">
                                <i class="bi bi-pencil-square"></i>
                            </button>
                        </form>
                    {% else %}
                        <form action="/like/post/{{post.id}}", method="POST">
                            <button
                                class="btn">
                                <i class="bi bi-hand-thumbs-up
                                    {% for like in curr_user.likes_posts %}
                                        {% if like.post_id == post.id %}
                                            text-danger
                                        {% else %}
                                            
                                        {% endif %}
                                    {% endfor %}
                                "></i>
                            </button>
                        </form>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        {% endfor %}
    {% endfor %}
</div>
{% block endif %}
{% endblock%}
{% endblock %}


